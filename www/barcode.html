<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ترازوی هوشمند </title>
   <link rel="stylesheet" href="/style.css">
   <link rel="stylesheet" href="/icons.css">

</head>
<body>
  
  <p style="text-align: center;">
    <img src="logo.png" alt="راهکارسازان آوان" style="width:200px">
      </p>
    
    
      <img src="line.png" style="width:300px"><br/><br/>
    

  <h1 id="barcode" class="barcode">0000000000000000</h1> 
 <h1 class="weight" id="weight">0kg</h1>
 <h1 class="city" id="city">Rj</h1>
 <br/><img src="line.png" style="width:300px"><br/><br/>

 <a href='/'  class='button-54'  style="  background-color: #ffffff  !important;" >بازگشت </a>
    <br/><br/><br/>

<script>



let last_barcode = 'not set'
let last_weight = 0.0


async function get_data(){
  let url = '/getdata';

      fetch(url)
      .then(res =>  res.json())
      .then(result =>{
          let barcode = document.getElementById('barcode');
          let weight = document.getElementById('weight');
          let city = document.getElementById('city');

          if(result && ((result.barcode != last_barcode && result.barcode.length>0) ||
                       (result.weight != last_weight )))
          
          {
            barcode.innerHTML = result.barcode;
            city.innerHTML = result.city;
            weight.innerHTML = result.weight +'kg';
            last_barcode = result.barcode;
            last_weight = result.weight;
        }
      })
      .catch(err => console.log(err));
  }


  setInterval(get_data, 500);

</script>

</body>
</html>